---
Generated: 2026-01-08 10:00:00
Ticket Number: 43
---

## Title

Implement epic management usecases with progress calculation

## Type

Feature

## Priority

High

## Story Points

5

## Labels

- domain
- usecases
- epic
- clean-architecture

## Git Branch

`feat/workbench-43-epic-usecases`

## Description

Implement all epic-related usecases required to manage epics and their relationship to tickets, including creation, update, deletion with ticket unassignment, listing with progress, and detail retrieval. These usecases will orchestrate the `EpicRepository` (and ticket-related ports where needed) to expose a clean domain API for the presentation layer.

## User Story

As a project member, I want to manage epics and see their progress so that I can understand how tickets contribute to larger project goals.

## Scope

This ticket covers the design and implementation of all epic-related usecases mentioned in the planning document section 2.3 for the "Epic" sub area:

- Create Epic Use Case
- Update Epic Use Case
- Delete Epic Use Case
- List Epics Use Case
- Get Epic Detail Use Case

## Acceptance Criteria

1. **Create Epic Use Case**
   - Given valid epic input (name, description, and any other required fields), `createEpic` creates a new epic through the `EpicRepository` and returns a domain `Epic`.
   - Given invalid input (e.g., missing required fields, violating length constraints), `createEpic` fails with a domain validation error before calling the repository.

2. **Update Epic Use Case**
   - `updateEpic` allows updating the epic name and description while preserving invariants (e.g., epics belong to a single project).
   - If the update violates domain rules (e.g., empty name, invalid project relation), the usecase returns a typed domain error without calling the repository.

3. **Delete Epic Use Case**
   - `deleteEpic` deletes an epic by id and ensures that tickets previously assigned to that epic are unassigned (or reassigned according to domain rules) via the ticket-related port(s).
   - If tickets cannot be safely unassigned or some constraint is violated, the usecase returns a domain error, and the epic is not deleted.

4. **List Epics Use Case**
   - `listEpics` returns a list of epics for a given project, each including a progress indicator based on linked tickets (e.g., ratio of done tickets to total tickets).
   - If no epics exist, the usecase returns an empty list without error.

5. **Get Epic Detail Use Case**
   - `getEpicDetail` returns a complete epic representation, including description, progress, and linked tickets (with at least id, title, and status).
   - If the epic does not exist, the usecase returns a typed "not found" domain error.

## Technical Considerations

- **Domain**
  - Reuse or extend existing epic domain types and schemas to validate input and output.
  - Define a clear progress model for epics (e.g., completion percentage or status) based on linked ticket statuses.
- **Usecases**
  - Implement usecases under `core/usecases/epic/` (e.g., `createEpic`, `updateEpic`, `deleteEpic`, `listEpics`, `getEpicDetail`).
  - Each usecase:
    - Uses Zod schemas for validating input data.
    - Depends only on ports (`EpicRepository`, `TicketRepository` when needed) from `core/ports/`.
    - Returns domain types enriched with calculated progress when appropriate.
- **Ports**
  - Ensure `EpicRepository` and related ports expose the required operations:
    - Creation, update, delete, list, and get by id for epics.
    - Ticket retrieval by epic for progress and detail calculations.
  - Extend ports only when necessary and keep them focused on repository responsibilities.
- **Infrastructure**
  - No direct infrastructure updates in this ticket; epic usecases must be fully testable using mocked ports.
- **Presentation**
  - No UI changes; integration in hooks and components will be done in separate tickets.

## Definition of Done

- All epic-related usecases implemented in `core/usecases/epic/` according to the Scope.
- Input validation:
  - All public usecase inputs validated via Zod schemas in the domain layer.
  - Invalid inputs consistently mapped to domain validation errors.
- Domain modeling:
  - Epic progress calculation implemented in a pure domain function or inside the epic usecases, with clear, documented rules.
- Tests:
  - Jest unit tests created or updated under `__tests__/core/usecases/epic/` covering:
    - Success paths for each usecase.
    - Failure scenarios (validation errors, not found, constraint violations).
    - Progress calculation edge cases (no tickets, all done, mixed statuses).
  - Repositories fully mocked using `__mocks__/core/ports/epicRepository.ts` and `ticketRepository.ts`.
- Quality:
  - Code passes ESLint and TypeScript checks.
  - Imports follow the project import order and absolute `@/` paths.
  - Short JSDoc comments describe each usecaseâ€™s responsibility and main domain rules.
