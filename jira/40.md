---
Generated: 2025-01-27 15:00:00
Ticket Number: 40
---

# Board Business Rules

**Type:** Task  
**Priority:** High  
**Story Points:** 3  
**Labels:** domain, business-rules, board, column, validation, core  
**Git Branch:** `feat/workbench-40-board-business-rules`

## Description

Implement Board and Column business rules as pure domain functions. These rules enforce constraints like column ordering, status uniqueness per board, and board-column relationship validation.

## User Story

As a developer, I want Board and Column business rules implemented so that board constraints are enforced at the domain level before data persistence.

## Acceptance Criteria

1. **Column Ordering Rules**
   - [ ] Function `validateColumnOrder()` that ensures column positions are valid
   - [ ] Function validates position is non-negative integer
   - [ ] Function ensures no duplicate positions within same board
   - [ ] Function validates position sequence (gaps allowed, but no duplicates)

2. **Status Uniqueness Rules**
   - [ ] Function `validateColumnStatusUniqueness()` that ensures status is unique per board
   - [ ] Function validates that no two columns in same board have same status
   - [ ] Function accepts list of columns for a board
   - [ ] Returns validation result (success/error)

3. **Board-Column Relationship Rules**
   - [ ] Function `validateBoardColumnRelationship()` that validates column belongs to board
   - [ ] Function ensures `column.boardId` matches `board.id`
   - [ ] Function validates board exists (when boardId provided)

4. **Column Data Validation**
   - [ ] Function `validateColumn()` that validates column data integrity
   - [ ] Column name must be non-empty string
   - [ ] Column status must be non-empty string
   - [ ] Column position must be non-negative integer
   - [ ] Column must belong to a valid board

5. **Board Data Validation**
   - [ ] Function `validateBoard()` that validates board data integrity
   - [ ] Board must belong to a valid project
   - [ ] Board validation integrated with column validation

6. **Composite Validation**
   - [ ] Function `validateBoardWithColumns()` that validates board and all its columns
   - [ ] Combines board validation, column validation, ordering, and uniqueness
   - [ ] Returns validation result (success/error)

7. **Error Handling**
   - [ ] Domain errors defined for validation failures
   - [ ] Clear error messages for each validation failure
   - [ ] Errors are domain-specific (not infrastructure errors)

## Technical Considerations

- **Domain Layer**: Business rules in `core/domain/board.rules.ts` (pure TypeScript, no external dependencies)
- **Pure Functions**: All rules are pure functions without side effects
- **No Infrastructure**: Rules do not call repositories or external services
- **Type Safety**: All functions properly typed with TypeScript
- **Reusability**: Rules can be used by usecases before calling repositories
- **Column List Validation**: Functions accept arrays of columns for batch validation

## Definition of Done

- [ ] `validateColumnOrder()` function implemented
- [ ] `validateColumnStatusUniqueness()` function implemented
- [ ] `validateBoardColumnRelationship()` function implemented
- [ ] `validateColumn()` function implemented
- [ ] `validateBoard()` function implemented
- [ ] `validateBoardWithColumns()` composite function implemented
- [ ] Domain errors defined for validation failures
- [ ] All functions properly typed
- [ ] Unit tests written for all business rules
- [ ] No external dependencies in domain layer
- [ ] No TypeScript errors

## Related Components

- `core/domain/board.rules.ts` (new file)
- `core/domain/board.schema.ts` (uses Board and Column types)
- `core/domain/project.schema.ts` (uses Project types for validation)
- `core/domain/repositoryError.ts` (reference for error patterns)
- Future: Board usecases (will use these rules)
- `__tests__/core/domain/board.rules.test.ts` (unit tests)
