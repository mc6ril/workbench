---
Generated: 2026-01-11 20:22:23
Ticket Number: 46
---

## Title

Create database tables for Projects, Tickets, Epics, Boards and Columns

## Type

Task

## Priority

High

## Story Points

8

## Labels

- infrastructure
- database
- schema
- migrations
- supabase
- postgres

## Git Branch

`feat/workbench-46-database-tables`

## Description

Create database tables for all core entities: Projects, Tickets, Epics, Boards and Columns. These tables form the foundation of the database schema and must support all entity relationships, field types, and domain constraints. Tables will be created using Supabase migration files.

## User Story

As a developer, I want database tables for all core entities so that the application can persist and retrieve project data, tickets, epics, boards and columns.

## Scope

This ticket covers the implementation of all table creation mentioned in the planning document section 3.2 for the "Tables" sub-area:

- Projects Table
- Tickets Table
- Epics Table
- Boards Table
- Columns Table

## Acceptance Criteria

1. **Projects Table**
   - [ ] Table `projects` created in migration file
   - [ ] Fields: `id` (UUID, primary key), `name` (text, not null), `created_at` (timestamptz, default now), `updated_at` (timestamptz, default now)
   - [ ] Primary key constraint on `id`
   - [ ] `updated_at` trigger to auto-update on row modification

2. **Tickets Table**
   - [ ] Table `tickets` created in migration file
   - [ ] Fields: `id` (UUID, primary key), `project_id` (UUID, foreign key to projects), `title` (text, not null), `description` (text, nullable), `status` (text, not null), `position` (integer, not null), `epic_id` (UUID, foreign key to epics, nullable), `parent_id` (UUID, foreign key to tickets, nullable), `created_at` (timestamptz, default now), `updated_at` (timestamptz, default now)
   - [ ] Primary key constraint on `id`
   - [ ] Foreign key constraints: `project_id` → `projects.id`, `epic_id` → `epics.id`, `parent_id` → `tickets.id`
   - [ ] `updated_at` trigger to auto-update on row modification
   - [ ] Note: Foreign keys will be enforced after tables are created (order matters in migrations)

3. **Epics Table**
   - [ ] Table `epics` created in migration file
   - [ ] Fields: `id` (UUID, primary key), `project_id` (UUID, foreign key to projects), `name` (text, not null), `description` (text, nullable), `created_at` (timestamptz, default now), `updated_at` (timestamptz, default now)
   - [ ] Primary key constraint on `id`
   - [ ] Foreign key constraint: `project_id` → `projects.id`
   - [ ] `updated_at` trigger to auto-update on row modification

4. **Boards Table**
   - [ ] Table `boards` created in migration file
   - [ ] Fields: `id` (UUID, primary key), `project_id` (UUID, foreign key to projects), `created_at` (timestamptz, default now), `updated_at` (timestamptz, default now)
   - [ ] Primary key constraint on `id`
   - [ ] Foreign key constraint: `project_id` → `projects.id`
   - [ ] `updated_at` trigger to auto-update on row modification

5. **Columns Table**
   - [ ] Table `columns` created in migration file
   - [ ] Fields: `id` (UUID, primary key), `board_id` (UUID, foreign key to boards), `name` (text, not null), `status` (text, not null), `position` (integer, not null), `created_at` (timestamptz, default now), `updated_at` (timestamptz, default now)
   - [ ] Primary key constraint on `id`
   - [ ] Foreign key constraint: `board_id` → `boards.id`
   - [ ] `updated_at` trigger to auto-update on row modification

6. **Migration File**
   - [ ] Migration file created in `supabase/migrations/` with descriptive name (e.g., `YYYYMMDDHHMMSS_create_core_tables.sql`)
   - [ ] Tables created in correct order (projects first, then epics/boards, then tickets/columns)
   - [ ] Migration is idempotent (uses `IF NOT EXISTS` where appropriate)
   - [ ] Migration includes comments explaining table structure

7. **Database Setup**
   - [ ] Migration can be applied to Supabase database
   - [ ] Tables are created successfully
   - [ ] Field types match domain entity types
   - [ ] Nullable/non-nullable fields match domain schema

## Technical Considerations

- **Migration Files**: Use Supabase migration system in `supabase/migrations/`
- **Table Order**: Create tables in dependency order (projects → epics/boards → tickets/columns)
- **UUID Generation**: Use `gen_random_uuid()` or `uuid_generate_v4()` for primary keys
- **Timestamps**: Use `timestamptz` (timestamp with timezone) for all timestamp fields
- **Updated At Trigger**: Create trigger function to auto-update `updated_at` field (reusable across tables)
- **Foreign Keys**: Add foreign keys after all tables are created (or in separate migration)
- **Field Names**: Use snake_case for database fields (matches Supabase convention)
- **Field Types**: Match PostgreSQL types to TypeScript domain types (UUID, text, integer, timestamptz)
- **Nullable Fields**: Match nullable fields to domain schema (description, epicId, parentId are nullable)
- **Dependencies**: Tables depend on domain entity definitions (already exist)

## Definition of Done

- [ ] All 5 tables created in migration file
- [ ] Tables created in correct dependency order
- [ ] All fields defined with correct types and constraints
- [ ] Primary keys defined for all tables
- [ ] Foreign keys defined (or documented for separate migration)
- [ ] `updated_at` triggers created
- [ ] Migration file created and tested
- [ ] Migration can be applied successfully
- [ ] Tables match domain entity structure
- [ ] Migration is idempotent and well-documented
- [ ] Code review completed
