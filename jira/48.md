---
Generated: 2026-01-11 20:22:23
Ticket Number: 48
---

## Title

Create database indexes for performance optimization

## Type

Task

## Priority

Medium

## Story Points

3

## Labels

- infrastructure
- database
- performance
- indexes
- migrations
- supabase
- postgres

## Git Branch

`feat/workbench-48-database-indexes`

## Description

Create database indexes on foreign keys, status fields, position fields, and frequently queried columns to optimize query performance. Indexes will improve the speed of common queries like filtering tickets by project, status, epic, and ordering by position.

## User Story

As a developer, I want database indexes on frequently queried columns so that common queries like filtering tickets by project or status execute quickly, even as the database grows.

## Scope

This ticket covers the implementation of indexes mentioned in the planning document section 3.2 for the "Indexes" sub-area:

- Performance Indexes (foreign keys, status, position, frequently queried fields)

## Acceptance Criteria

1. **Foreign Key Indexes**
   - [ ] Index on `tickets.project_id` (foreign key to projects)
   - [ ] Index on `tickets.epic_id` (foreign key to epics, nullable)
   - [ ] Index on `tickets.parent_id` (foreign key to tickets, nullable)
   - [ ] Index on `epics.project_id` (foreign key to projects)
   - [ ] Index on `boards.project_id` (foreign key to projects)
   - [ ] Index on `columns.board_id` (foreign key to boards)

2. **Status and Position Indexes**
   - [ ] Index on `tickets.status` (for filtering by status)
   - [ ] Index on `tickets.position` (for ordering by position)
   - [ ] Composite index on `tickets(status, position)` if queries filter by status and order by position
   - [ ] Index on `columns.status` (if queries filter columns by status)
   - [ ] Index on `columns.position` (for ordering columns by position)

3. **Composite Indexes (if needed)**
   - [ ] Composite index on `tickets(project_id, status)` if queries filter by project and status
   - [ ] Composite index on `tickets(project_id, epic_id)` if queries filter by project and epic
   - [ ] Composite indexes documented with query pattern justification

4. **Migration File**
   - [ ] Migration file created in `supabase/migrations/` with descriptive name (e.g., `YYYYMMDDHHMMSS_add_performance_indexes.sql`)
   - [ ] Indexes created with `CREATE INDEX` statements
   - [ ] Indexes use descriptive names (e.g., `idx_tickets_project_id`, `idx_tickets_status`)
   - [ ] Migration is idempotent (uses `IF NOT EXISTS`)
   - [ ] Migration includes comments explaining index purposes

5. **Index Documentation**
   - [ ] Indexes documented with query patterns they optimize
   - [ ] Composite indexes justified with query examples
   - [ ] Index trade-offs documented (write performance vs read performance)

6. **Database Setup**
   - [ ] Migration can be applied to Supabase database
   - [ ] Indexes are created successfully
   - [ ] Indexes improve query performance (measured or verified)
   - [ ] Write performance impact is acceptable

## Technical Considerations

- **Migration Files**: Use Supabase migration system in `supabase/migrations/`
- **Index Creation**: Use `CREATE INDEX` with `IF NOT EXISTS` for idempotency
- **Index Naming**: Use descriptive names like `idx_{table}_{column}` or `idx_{table}_{columns}`
- **B-Tree Indexes**: Use default B-tree indexes (PostgreSQL default) for most cases
- **Partial Indexes**: Consider partial indexes for nullable foreign keys (e.g., `WHERE epic_id IS NOT NULL`)
- **Composite Indexes**: Create composite indexes for queries filtering/ordering by multiple columns
- **Index Order**: Column order in composite indexes matters (most selective first, or match query pattern)
- **Write Performance**: Indexes slow down writes (INSERT, UPDATE, DELETE) but speed up reads (SELECT)
- **Index Maintenance**: PostgreSQL automatically maintains indexes (no manual maintenance needed)
- **Query Patterns**: Indexes should match actual query patterns from usecases/repositories
- **Dependencies**: Indexes depend on tables existing (from separate ticket)

## Definition of Done

- [ ] All foreign key indexes created
- [ ] Status and position indexes created
- [ ] Composite indexes created (if needed)
- [ ] Migration file created and tested
- [ ] Migration can be applied successfully
- [ ] Indexes use descriptive names
- [ ] Indexes are documented with query patterns
- [ ] Migration is idempotent and well-documented
- [ ] Code review completed
- [ ] Indexes improve query performance (verified or measured)
